version: "3.9"
services:
  summarizer:
    build:
      context: ./summarizer_service
      dockerfile: Dockerfile
    container_name: whatsapp_summarizer
    restart: unless-stopped
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:5001/health" ]
      interval: 60s
      timeout: 3s
      retries: 5
    env_file:
      - .env

  whatsapp_bot:
    build:
      context: ./whatsapp_client
      dockerfile: Dockerfile
    volumes:
      - ./auth:/app/auth
    container_name: whatsapp_bot
    depends_on:
      summarizer:
        condition: service_healthy
    env_file:
      - .env
    restart: unless-stopped
